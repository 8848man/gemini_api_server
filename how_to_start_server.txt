# 최초 서버 세팅 방법
# requirements 의존성 설치
pip install -r requirements.txt

# 서버 실행중 pydantic-settings 에러 발생시
pip install pydantic-settings

# firebase firestore 인증(firebase firestore 인증 에러시)
gcloud auth application-default login

########서버 실행하는 방법

# 가상환경 활성화 (PowerShell)
.\venv\Scripts\Activate.ps1

# firebase firestore 인증(firebase firestore 인증 에러시)
gcloud auth application-default login

# FastAPI 서버 실행
uvicorn src.main:app --reload --host 0.0.0.0 --port 8000

########## 도커 이미지 빌드 방법(GCR 배포)
docker build -t gcr.io/{프로젝트ID}/{이미지이름:태그 .}

# 로컬에 도커 푸쉬 권한을 부여
gcloud auth configure-docker

# 도커 이미지 빌드()
docker build -t gcr.io/level-harbor-468300-g9/gemini-api:latest-1 .

# 도커 이미지 푸시(구글 클라우드로)
docker push gcr.io/level-harbor-468300-g9/gemini-api:latest-1


# 푸쉬된 이미지를 배포
gcloud run deploy gemini-api --image gcr.io/level-harbor-468300-g9/gemini-api:latest-2 --platform managed --region asia-northeast3 --allow-unauthenticated
